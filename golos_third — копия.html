<!--
	0.5.29 - для тестнета
	0.5.30 - для текущей версии чейна
-->
<script src="auth.js"></script>
<script src="https://cdn.jsdelivr.net/npm/golos-js@0.5.29/dist/golos.min.js"></script>
<script>
// переключение на тестнет
/*golos.api.setOptions({
	'websocket': 'wss://ws.testnet.golos.io',
	'address_prefix': 'GLS',
	'chain_id': '5876894a41e6361bde2e73278f07340f2eb8b41c2facd29099de9deef6cdb679'
});*/
golos.config.set('websocket', 'wss://ws.testnet3.golos.io');
golos.config.set('address_prefix', 'GLS');
golos.config.set('chain_id', '5876894a41e6361bde2e73278f07340f2eb8b41c2facd29099de9deef6cdb679');

/**
 * login() авторизаций
 * @param {String} username - юзернейм пользователя
 * @param {String} password - пароль пользователя
*/
var username = 'golos-test';
var password = '5JCwo8Psq8vn6qBhkEPCbSV3TPVTWXkSVJxHK2LfwWfteUm3wdU';
golos.api.login(username, password, function(err, result) {
	//console.log(err, result);
	if ( ! err) {
		console.log('login', result);
	}
	//else console.error(err);
});
    
/**
 * comment() добавить пост
 * @param {Base58} wif - приватный posting ключ
 * @param {String} parentAuthor - для создания поста, поле пустое
 * @param {String} parentPermlink - главный тег
 * @param {String} author - автор поста
 * @param {String} permlink - url-адрес поста
 * @param {String} title - заголовок поста
 * @param {String} body - текст поста
 * @param {String} jsonMetadata - мета-данные поста (изображения, и т.д.)
*/
auth();
//var wif = '5JCwo8Psq8vn6qBhkEPCbSV3TPVTWXkSVJxHK2LfwWfteUm3wdU';
var parentAuthor = '';
var parentPermlink = 'testPermLink';
var author = 'golos-test';
var permlink = 'test-url';
var title = 'title_test';
var body = 'body_test';
var jsonMetadata = '{}';
golos.broadcast.comment(wif, parentAuthor, parentPermlink, author, permlink, title, body, jsonMetadata, function(err, result) {
	//console.log(err, result);
	if ( ! err) {
		console.log('comment', result);
	}
	else console.error(err);
});


/**
 * getDiscussionsByBlog() получение постов по автору и тегу
 * @param {Object} query - объект поиска включащий автора, тег, лимит
*/
/*var query = {
	select_authors: ['golos-test'],
	select_tags: ['tag'],
	limit: 100
};
golos.api.getDiscussionsByBlog(query, function(err, result) {
	//console.log(err, result);
	if ( ! err) {
		result.forEach(function(item) {
			console.log('getDiscussionsByBlog', item.title);
		});
	}
	else console.error(err);
});*/
    
/*var query = {	
	select_authors: ['vgolos4'],
    limit: 100,
};
golos.api.getDiscussionsByCreated(query, function(err, result) {
	//console.log(err, result);
	if ( ! err) {
		result.forEach(function(item) {
			console.log('getDiscussionsByCreated', item.title);
		});
	}
	else console.error(err);
});*/
    
</script>